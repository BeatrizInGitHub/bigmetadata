<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>US County &mdash; observatory 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/segment.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/menu.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_tabs/tabs.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.js"></script>
    <link rel="top" title="observatory 0.0.1 documentation" href="../../index.html" />
    <link rel="up" title="Boundaries" href="../boundary.html" />
    <link rel="next" title="Shoreline clipped US County" href="us.census.tiger.county_clipped.html" />
    <link rel="prev" title="Shoreline clipped US Congressional Districts" href="us.census.tiger.congressional_district_clipped.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="us-county">
<span id="us-census-tiger-county"></span><h1>US County<a class="headerlink" href="#us-county" title="Permalink to this headline">Â¶</a></h1>
<p>The primary legal divisions of most states are termed counties. In Louisiana, these divisions are known as parishes. In Alaska, which has no counties, the equivalent entities are the organized boroughs, city and boroughs, municipalities, and census areas; the latter of which are delineated cooperatively for statistical purposes by the state of Alaska and the Census Bureau. In four states (Maryland, Missouri, Nevada, and Virginia), there are one or more incorporated places that are independent of any county organization and thus constitute primary divisions of their states. These incorporated places are known as independent cities and are treated as equivalent entities for purposes of data presentation. The District of Columbia and Guam have no primary divisions, and each area is considered an equivalent entity for purposes of data presentation. All of the counties in Connecticut and Rhode Island and nine counties in Massachusetts were dissolved as functioning governmental entities; however, the Census Bureau continues to present data for these historical entities in order to provide comparable geographic units at the county level of the geographic hierarchy for these states and represents them as nonfunctioning legal entities in data products. The Census Bureau treats the following entities as equivalents of counties for purposes of data presentation: municipios in Puerto Rico, districts and islands in American Samoa, municipalities in the Commonwealth of the Northern Mariana Islands, and islands in the U.S. Virgin Islands. Each county or statistically equivalent entity is assigned a three-character numeric Federal Information Processing Series (FIPS) code based on alphabetical sequence that is unique within state and an eight-digit National Standard feature identifier.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-0 docutils container">
Boundaries within polygon</div>
<div class="item sphinx-data-tab-1 docutils container">
Boundaries by identifier in another table</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0 active docutils container">
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">cartodb_id</span><span class="p">,</span> <span class="n">the_geom</span><span class="p">,</span> <span class="k">name</span><span class="p">,</span> <span class="n">the_geom_webmercator</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="k">OVER</span> <span class="p">()</span> <span class="k">AS</span> <span class="n">cartodb_id</span><span class="p">,</span>
       <span class="n">the_geom</span><span class="p">,</span>
       <span class="n">geom_refs</span><span class="p">,</span>
       <span class="n">ST_TRANSFORM</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span> <span class="n">the_geom_webmercator</span>
<span class="k">FROM</span> <span class="n">OBS_GetBoundariesByGeometry</span><span class="p">(</span>
  <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;POLYGON((-179.4 -15,-179.4 71.7,179.999 71.7,179.999 -15,-179.4 -15))&#39;</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
  <span class="s1">&#39;us.census.tiger.county&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-1 docutils container">
<p>Update the boundaries in another table matching the table&#8217;s ID column.</p>
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">WITH</span> <span class="k">data</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span> <span class="k">AS</span> <span class="n">id</span>
  <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span>
<span class="p">),</span>
<span class="n">meta</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">OBS_GetMeta</span><span class="p">(</span><span class="n">ST_MakeEnvelope</span><span class="p">(</span><span class="o">-</span><span class="mf">179</span><span class="p">,</span> <span class="mf">89</span><span class="p">,</span> <span class="mf">179</span><span class="p">,</span> <span class="o">-</span><span class="mf">89</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
    <span class="s1">&#39;[{&quot;geom_id&quot;: &quot;us.census.tiger.county&quot;}]&#39;</span>
  <span class="p">)</span> <span class="n">meta</span>
<span class="p">)</span>
<span class="k">UPDATE</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span> <span class="k">SET</span>
      <span class="n">the_geom</span> <span class="o">=</span> <span class="p">(</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span>
      <span class="n">the_geom_webmercator</span> <span class="o">=</span> <span class="n">ST_Transform</span><span class="p">((</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">OBS_GetData</span><span class="p">(</span>
      <span class="p">(</span><span class="k">SELECT</span> <span class="n">Array_agg</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">data</span><span class="p">),</span>
      <span class="p">(</span><span class="k">SELECT</span> <span class="n">meta</span> <span class="k">FROM</span> <span class="n">meta</span><span class="p">))</span> <span class="n">obs_data</span>
<span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span><span class="mf">.</span><span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">obs_data</span><span class="mf">.</span><span class="n">id</span>
</pre></div>
</div>
<p>Obtain boundaries matched to another table&#8217;s ID column.</p>
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">WITH</span> <span class="n">ids</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">ids</span>
  <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">table_with_ids</span><span class="o">&gt;</span>
<span class="p">),</span>
<span class="n">meta</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">OBS_GetMeta</span><span class="p">(</span><span class="n">ST_MakeEnvelope</span><span class="p">(</span><span class="o">-</span><span class="mf">179</span><span class="p">,</span> <span class="mf">89</span><span class="p">,</span> <span class="mf">179</span><span class="p">,</span> <span class="o">-</span><span class="mf">89</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
    <span class="s1">&#39;[{&quot;geom_id&quot;: &quot;us.census.tiger.county&quot;}]&#39;</span>
  <span class="p">)</span> <span class="n">meta</span>
<span class="p">)</span>
<span class="k">SELECT</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="k">OVER</span> <span class="p">()</span> <span class="k">AS</span> <span class="n">cartodb_id</span><span class="p">,</span>
       <span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;geomref&#39;</span> <span class="k">as</span> <span class="n">geomref</span><span class="p">,</span>
       <span class="p">(</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span> <span class="k">as</span> <span class="n">the_geom</span><span class="p">,</span>
       <span class="n">ST_Transform</span><span class="p">((</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom_webmercator</span>
<span class="k">FROM</span> <span class="n">OBS_GetData</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">ids</span> <span class="k">FROM</span> <span class="n">ids</span><span class="p">),</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">meta</span> <span class="k">FROM</span> <span class="n">meta</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this headline">Â¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../../sources.html#us-census-tiger-tiger-source"><span class="std std-ref">US Census TIGER/Line Shapefiles</span></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="time-default-is-latest">
<h2>Time (default is latest)<a class="headerlink" href="#time-default-is-latest" title="Permalink to this headline">Â¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>2015</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">Â¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../../licenses.html#tags-no-restrictions"><span class="std std-ref">Unrestricted</span></a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">US County</a><ul>
<li><a class="reference internal" href="#source">Source</a></li>
<li><a class="reference internal" href="#time-default-is-latest">Time (default is latest)</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../united_states.html">United States</a><ul>
  <li><a href="../boundary.html">Boundaries</a><ul>
      <li>Previous: <a href="us.census.tiger.congressional_district_clipped.html" title="previous chapter">Shoreline clipped US Congressional Districts</a></li>
      <li>Next: <a href="us.census.tiger.county_clipped.html" title="next chapter">Shoreline clipped US County</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/united_states/boundary/us.census.tiger.county.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, CARTO.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/united_states/boundary/us.census.tiger.county.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>