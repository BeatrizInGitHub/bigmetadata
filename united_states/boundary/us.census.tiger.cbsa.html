<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Core Based Statistical Area (CBSA) &mdash; observatory 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/segment.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/menu.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_tabs/tabs.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_tabs/semantic-ui-2.2.7/tab.min.js"></script>
    <link rel="top" title="observatory 0.0.1 documentation" href="../../index.html" />
    <link rel="up" title="Boundaries" href="../boundary.html" />
    <link rel="next" title="Shoreline clipped Core Based Statistical Area (CBSA)" href="us.census.tiger.cbsa_clipped.html" />
    <link rel="prev" title="Shoreline clipped US Census Block Groups" href="us.census.tiger.block_group_clipped.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="core-based-statistical-area-cbsa">
<span id="us-census-tiger-cbsa"></span><h1>Core Based Statistical Area (CBSA)<a class="headerlink" href="#core-based-statistical-area-cbsa" title="Permalink to this headline">¶</a></h1>
<p>Core Based Statistical Areas (CBSAs) consist of the county or counties or equivalent entities associated with at least one core (urbanized area or urban cluster) of at least 10,000 population, plus adjacent counties having a high degree of social and economic integration with the core as measured through commuting ties with the counties associated with the core. The general concept of a CBSA is that of a
core area containing a substantial population nucleus, together with adjacent communities having a high degree of economic and social integration with that core. The term “core based statistical area” became effective in 2003 and refers collectively to metropolitan statistical areas and micropolitan statistical areas. The U.S. Office of Management and Budget (OMB) defines CBSAs to provide a nationally consistent set of geographic entities for the United States and Puerto Rico for use in tabulating and presenting statistical data. Current CBSAs are based on application of the 2000 standards (published in the Federal Register of December 27, 2000) with Census 2000 data. The first set of areas defined based on the 2000 standards were announced on June 6, 2003; subsequent updates have been made to the universe of CBSAs and related statistical areas. No CBSAs are defined in the Island Areas. Statistical areas related to CBSAs include metropolitan divisions, combined statistical areas (CSAs), New England city and town areas (NECTAs), NECTA divisions, and combined NECTAs.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-0 docutils container">
Boundaries within polygon</div>
<div class="item sphinx-data-tab-1 docutils container">
Boundaries by identifier in another table</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0 active docutils container">
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">cartodb_id</span><span class="p">,</span> <span class="n">the_geom</span><span class="p">,</span> <span class="k">name</span><span class="p">,</span> <span class="n">the_geom_webmercator</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="k">OVER</span> <span class="p">()</span> <span class="k">AS</span> <span class="n">cartodb_id</span><span class="p">,</span>
       <span class="n">the_geom</span><span class="p">,</span>
       <span class="n">geom_refs</span><span class="p">,</span>
       <span class="n">ST_TRANSFORM</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span> <span class="n">the_geom_webmercator</span>
<span class="k">FROM</span> <span class="n">OBS_GetBoundariesByGeometry</span><span class="p">(</span>
  <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;POLYGON((-178.8 17.4,-178.8 65.7,-65.1 65.7,-65.1 17.4,-178.8 17.4))&#39;</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
  <span class="s1">&#39;us.census.tiger.cbsa&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-1 docutils container">
<p>Update the boundaries in another table matching the table&#8217;s ID column.</p>
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">WITH</span> <span class="k">data</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span> <span class="k">AS</span> <span class="n">id</span>
  <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span>
<span class="p">),</span>
<span class="n">meta</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">OBS_GetMeta</span><span class="p">(</span><span class="n">ST_MakeEnvelope</span><span class="p">(</span><span class="o">-</span><span class="mf">179</span><span class="p">,</span> <span class="mf">89</span><span class="p">,</span> <span class="mf">179</span><span class="p">,</span> <span class="o">-</span><span class="mf">89</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
    <span class="s1">&#39;[{&quot;geom_id&quot;: &quot;us.census.tiger.cbsa&quot;}]&#39;</span>
  <span class="p">)</span> <span class="n">meta</span>
<span class="p">)</span>
<span class="k">UPDATE</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span> <span class="k">SET</span>
      <span class="n">the_geom</span> <span class="o">=</span> <span class="p">(</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span>
      <span class="n">the_geom_webmercator</span> <span class="o">=</span> <span class="n">ST_Transform</span><span class="p">((</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">OBS_GetData</span><span class="p">(</span>
      <span class="p">(</span><span class="k">SELECT</span> <span class="n">Array_agg</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">data</span><span class="p">),</span>
      <span class="p">(</span><span class="k">SELECT</span> <span class="n">meta</span> <span class="k">FROM</span> <span class="n">meta</span><span class="p">))</span> <span class="n">obs_data</span>
<span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">table_to_update</span><span class="o">&gt;</span><span class="mf">.</span><span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">obs_data</span><span class="mf">.</span><span class="n">id</span>
</pre></div>
</div>
<p>Obtain boundaries matched to another table&#8217;s ID column.</p>
<div class="highlight-postgresql"><div class="highlight"><pre><span></span><span class="k">WITH</span> <span class="n">ids</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">ARRAY_AGG</span><span class="p">(</span><span class="o">&lt;</span><span class="n">geo_id</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">ids</span>
  <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">table_with_ids</span><span class="o">&gt;</span>
<span class="p">),</span>
<span class="n">meta</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">OBS_GetMeta</span><span class="p">(</span><span class="n">ST_MakeEnvelope</span><span class="p">(</span><span class="o">-</span><span class="mf">179</span><span class="p">,</span> <span class="mf">89</span><span class="p">,</span> <span class="mf">179</span><span class="p">,</span> <span class="o">-</span><span class="mf">89</span><span class="p">,</span> <span class="mf">4326</span><span class="p">),</span>
    <span class="s1">&#39;[{&quot;geom_id&quot;: &quot;us.census.tiger.cbsa&quot;}]&#39;</span>
  <span class="p">)</span> <span class="n">meta</span>
<span class="p">)</span>
<span class="k">SELECT</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="k">OVER</span> <span class="p">()</span> <span class="k">AS</span> <span class="n">cartodb_id</span><span class="p">,</span>
       <span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;geomref&#39;</span> <span class="k">as</span> <span class="n">geomref</span><span class="p">,</span>
       <span class="p">(</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span> <span class="k">as</span> <span class="n">the_geom</span><span class="p">,</span>
       <span class="n">ST_Transform</span><span class="p">((</span><span class="k">data</span><span class="o">-&gt;</span><span class="mf">0</span><span class="o">-&gt;&gt;</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">::</span><span class="n">Geometry</span><span class="p">,</span> <span class="mf">3857</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom_webmercator</span>
<span class="k">FROM</span> <span class="n">OBS_GetData</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">ids</span> <span class="k">FROM</span> <span class="n">ids</span><span class="p">),</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">meta</span> <span class="k">FROM</span> <span class="n">meta</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="source">
<h2>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../../sources.html#us-census-tiger-tiger-source"><span class="std std-ref">US Census TIGER/Line Shapefiles</span></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="time-default-is-latest">
<h2>Time (default is latest)<a class="headerlink" href="#time-default-is-latest" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>2015</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../../licenses.html#tags-no-restrictions"><span class="std std-ref">Unrestricted</span></a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Core Based Statistical Area (CBSA)</a><ul>
<li><a class="reference internal" href="#source">Source</a></li>
<li><a class="reference internal" href="#time-default-is-latest">Time (default is latest)</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../united_states.html">United States</a><ul>
  <li><a href="../boundary.html">Boundaries</a><ul>
      <li>Previous: <a href="us.census.tiger.block_group_clipped.html" title="previous chapter">Shoreline clipped US Census Block Groups</a></li>
      <li>Next: <a href="us.census.tiger.cbsa_clipped.html" title="next chapter">Shoreline clipped Core Based Statistical Area (CBSA)</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/united_states/boundary/us.census.tiger.cbsa.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, CARTO.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/united_states/boundary/us.census.tiger.cbsa.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>